from oaiso.tests import distance_filter, contents_filter
import sys
import csv

#入力項目
filename = 'kyobashi_r.csv' #ファイル名(例：地名_価格帯(c OR r OR e).csv)
lat = 35.676097
lng = 139.768709
bud = 'r' #価格帯(c OR r OR e)


dirpass = '/home/nakanopbl2017/cgi-bin/test/' + filename #パス
dist_ref, dist = distance_filter(lat, lng) #距離フィルタ

#ユーザベクトル全パターン
if bud == 'c':
	uvec_list = [
	[1,0,0,1,0,0,0,1,0],
	[1,0,0,1,0,0,0,0,1],
	[1,0,0,1,0.5,0,0,1,0],
	[1,0,0,1,0.5,0,0,0,1],
	[1,0,0,1,0,0.5,0,1,0],
	[1,0,0,1,0,0.5,0,0,1],
	[1,0,0,1,0,0,0.5,1,0],
	[1,0,0,1,0,0,0.5,0,1],
	[1,0,0,0.5,1,0,0,1,0],
	[1,0,0,0.5,1,0,0,0,1],
	[1,0,0,0,1,0,0,1,0],
	[1,0,0,0,1,0,0,0,1],
	[1,0,0,0,1,0.5,0,1,0],
	[1,0,0,0,1,0.5,0,0,1],
	[1,0,0,0,1,0,0.5,1,0],
	[1,0,0,0,1,0,0.5,0,1],
	[1,0,0,0.5,0,1,0,1,0],
	[1,0,0,0.5,0,1,0,0,1],
	[1,0,0,0,0.5,1,0,1,0],
	[1,0,0,0,0.5,1,0,0,1],
	[1,0,0,0,0,1,0,1,0],
	[1,0,0,0,0,1,0,0,1],
	[1,0,0,0,0,1,0.5,1,0],
	[1,0,0,0,0,1,0.5,0,1],
	[1,0,0,0.5,0,0,1,1,0],
	[1,0,0,0.5,0,0,1,0,1],
	[1,0,0,0,0.5,0,1,1,0],
	[1,0,0,0,0.5,0,1,0,1],
	[1,0,0,0,0,0.5,1,1,0],
	[1,0,0,0,0,0.5,1,0,1],
	[1,0,0,0,0,0,1,1,0],
	[1,0,0,0,0,0,1,0,1]
	]

elif bud == 'r':
	uvec_list = [
	[0,1,0,1,0,0,0,1,0],
	[0,1,0,1,0,0,0,0,1],
	[0,1,0,1,0.5,0,0,1,0],
	[0,1,0,1,0.5,0,0,0,1],
	[0,1,0,1,0,0.5,0,1,0],
	[0,1,0,1,0,0.5,0,0,1],
	[0,1,0,1,0,0,0.5,1,0],
	[0,1,0,1,0,0,0.5,0,1],
	[0,1,0,0.5,1,0,0,1,0],
	[0,1,0,0.5,1,0,0,0,1],
	[0,1,0,0,1,0,0,1,0],
	[0,1,0,0,1,0,0,0,1],
	[0,1,0,0,1,0.5,0,1,0],
	[0,1,0,0,1,0.5,0,0,1],
	[0,1,0,0,1,0,0.5,1,0],
	[0,1,0,0,1,0,0.5,0,1],
	[0,1,0,0.5,0,1,0,1,0],
	[0,1,0,0.5,0,1,0,0,1],
	[0,1,0,0,0.5,1,0,1,0],
	[0,1,0,0,0.5,1,0,0,1],
	[0,1,0,0,0,1,0,1,0],
	[0,1,0,0,0,1,0,0,1],
	[0,1,0,0,0,1,0.5,1,0],
	[0,1,0,0,0,1,0.5,0,1],
	[0,1,0,0.5,0,0,1,1,0],
	[0,1,0,0.5,0,0,1,0,1],
	[0,1,0,0,0.5,0,1,1,0],
	[0,1,0,0,0.5,0,1,0,1],
	[0,1,0,0,0,0.5,1,1,0],
	[0,1,0,0,0,0.5,1,0,1],
	[0,1,0,0,0,0,1,1,0],
	[0,1,0,0,0,0,1,0,1]
	]

else:
	uvec_list = [
	[0,0,1,1,0,0,0,1,0],
	[0,0,1,1,0,0,0,0,1],
	[0,0,1,1,0.5,0,0,1,0],
	[0,0,1,1,0.5,0,0,0,1],
	[0,0,1,1,0,0.5,0,1,0],
	[0,0,1,1,0,0.5,0,0,1],
	[0,0,1,1,0,0,0.5,1,0],
	[0,0,1,1,0,0,0.5,0,1],
	[0,0,1,0.5,1,0,0,1,0],
	[0,0,1,0.5,1,0,0,0,1],
	[0,0,1,0,1,0,0,1,0],
	[0,0,1,0,1,0,0,0,1],
	[0,0,1,0,1,0.5,0,1,0],
	[0,0,1,0,1,0.5,0,0,1],
	[0,0,1,0,1,0,0.5,1,0],
	[0,0,1,0,1,0,0.5,0,1],
	[0,0,1,0.5,0,1,0,1,0],
	[0,0,1,0.5,0,1,0,0,1],
	[0,0,1,0,0.5,1,0,1,0],
	[0,0,1,0,0.5,1,0,0,1],
	[0,0,1,0,0,1,0,1,0],
	[0,0,1,0,0,1,0,0,1],
	[0,0,1,0,0,1,0.5,1,0],
	[0,0,1,0,0,1,0.5,0,1],
	[0,0,1,0.5,0,0,1,1,0],
	[0,0,1,0.5,0,0,1,0,1],
	[0,0,1,0,0.5,0,1,1,0],
	[0,0,1,0,0.5,0,1,0,1],
	[0,0,1,0,0,0.5,1,1,0],
	[0,0,1,0,0,0.5,1,0,1],
	[0,0,1,0,0,0,1,1,0],
	[0,0,1,0,0,0,1,0,1]
	]

header = ['user_vec', 'shop_vec', 'dist_score', 'distance [m]', 'cosθ', 'oaiso_score', 'id', 'shop_name', 'URL', 'genre', 'oaiso_genre', 'lat', 'lng', 'address'] #csvヘッダ

#シミュレーション結果
with open(dirpass, 'w', encoding='utf-8') as f:
	writer = csv.writer(f, lineterminator='\n')
	writer.writerow(header)

	for uvec in uvec_list:
		results = contents_filter(dist_ref, dist, uvec)[:100] #コンテンツフィルタ
		for row in results:
			writer.writerow(row)
			#print(row)
